FROM mariadb:latest

# install curl
RUN apt update && apt upgrade -y && apt install -y curl

# install node
SHELL ["/bin/bash", "--login", "-i", "-c"]
RUN curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash
RUN source /root/.bashrc && nvm install 13.8.0
SHELL ["/bin/bash", "--login", "-c"]

# add yarn repo
RUN curl -sS curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg \
	| sudo apt-key add - echo "deb https://dl.yarnpkg.com/debian/ stable main" \
	| sudo tee /etc/apt/sources.list.d/yarn.list

# install yarn and redis
RUN apt install -y \
	yarn \
	redis-server

# add Get5API
RUN mkdir /Get5API
COPY . /Get5API
WORKDIR /Get5API

EXPOSE 3301
